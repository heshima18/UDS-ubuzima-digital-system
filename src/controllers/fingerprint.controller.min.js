import WebSocket from"ws";var ws;export async function connectFP(host,callback){return host="ws://127.0.0.1:21187/fps",new Promise((resolve,reject)=>{ws=new WebSocket(host),ws.onopen=function(){resolve({success:!0,message:"connected to SDK!",type:"connection",socket:ws})},ws.onerror=function(e){console.log("there was an error while connecting to fp SDK"),reject({success:!1,message:"Error: there was an error while connecting to the fingerprint SDK!",type:"connection"})},ws.onmessage=function(evt){var obj=eval("("+evt.data+")");switch(obj.workmsg){case 1:callback({success:!1,message:"Please turn on or connect your device"});break;case 2:callback({success:"awaiting",message:"Please press your fingers..."});break;case 3:callback({success:"awaiting",message:"Please lift your finger..."});break;case 4:break;case 5:1==obj.retmsg?"null"==obj.data1||callback({success:!0,message:"Fingerprint template collection successful",type:"fp-data",data:obj.data1}):callback("Failed to collect fingerprint template");break;case 6:1==obj.retmsg?"null"==obj.data1||callback({success:!0,message:"Registered fingerprint template successfully",type:"fp-data",data:obj.data1}):callback({success:!1,message:"Failed to register fingerprint template"});break;case 7:"null"==obj.image||callback({success:!0,message:"Registered fingerprint template successfully",type:"fp-image",data:"data:image/png;base64,"+obj.image});break;case 8:callback({success:!1,message:"time out"});break;case 9:obj.retmsg<80?callback({success:!1,message:"Comparison score:",type:"comparison",data:obj.retmsg}):callback({success:!0,message:"Comparison score:",type:"comparison",data:obj.retmsg}),ws.close();break;case 10:if("null"==obj.image);else{var en4=document.getElementById("e4");en4.value=obj.image}break;case 15:1==obj.retmsg?callback({success:!0,message:"Reconnected device successfully"}):callback({success:!1,message:"Failed to reconnect device"});break;case 18:"null"==obj.image||callback({success:!0,message:"Registered fingerprint template successfully",type:"fp-image",data:"data:image/png;base64,"+obj.image});break;case 19:callback({success:!0,message:"Registered fingerprint template successfully",type:"fp-image",data:"data:image/png;base64,"+obj.image})}ws.close()},ws.onclose=function(){reject({success:!1,message:"connection to the fingerprint SDK was closed"})}})}export function MatchTemplate(e,s){if(!(e.length>256&&s.length>256))return 0;var a='{"cmd":"match","data1":"'+e+'","data2":"'+s+'"}';try{ws.send(a)}catch(e){return console.log(e),0}}