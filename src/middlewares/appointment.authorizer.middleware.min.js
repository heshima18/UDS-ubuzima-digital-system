import query from"../controllers/query.controller";import errorMessage from"../controllers/response.message.controller";import authenticateToken from"../controllers/token.verifier.controller";export const authorizeAppointmentAccess=async(e,r,s)=>{try{const{token:t}=e.body,o=e.params.id,n=authenticateToken(t);if(!n.success)return r.status(500).send({message:errorMessage.is_error,success:!1});let c=n.token.id,a=await query("select time from appointments  where (hc_provider = ? OR patient = ?) AND id = ?",[c,c,o]);if(!a)return r.status(500).send({message:errorMessage.is_error,success:!1});if(0==a.length)return r.status(401).send({message:errorMessage._err_forbidden,success:!1});s()}catch(e){console.log(e),r.status(500).send({message:errorMessage.is_error,success:!1})}};