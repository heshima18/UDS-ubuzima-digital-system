import{alertMessage,postschema,request,chSession,checkEmpty}from"../../../utils/functions.controller.js";chSession();const form=document.querySelector("form#form"),submitButton=form.querySelector('button[type="submit"]'),inputs=Array.from(form.querySelectorAll("input"));let show=form.querySelector("i.bx");show.addEventListener("click",e=>{show.classList.toggle("bx-hide"),show.classList.toggle("bx-show");let t=inputs.find(e=>"password"==e.name);"password"==t.type?t.type="text":t.type="password"}),form.addEventListener("submit",async e=>{e.preventDefault();let t,s,o=form.querySelectorAll("input"),r={};s=1;for(const e of o)t=checkEmpty(e),console.log(checkEmpty(e)),t||(s=0),Object.assign(r,{[e.name]:e.value});if(s){submitButton.setAttribute("disabled",!0),submitButton.innerText="signing in...",postschema.body=JSON.stringify(r);let e=await request("user-login",postschema);if(submitButton.removeAttribute("disabled"),submitButton.innerText="signin",e.success){for(const e of o)"username"==e.getAttribute("data-field-name")&&localStorage.setItem("userid",e.value.trim());window.location.href="../auth/"}else alertMessage(e.message)}});