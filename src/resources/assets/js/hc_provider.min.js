async function viewAppointmentDiv(e){let t=addshade(),s=document.createElement("div");t.appendChild(s),s.className="br-10p cntr card p-10p bsbb w-450p h-a b-mgc-resp",s.innerHTML=`<div class="w-100 h-100 p-5p bp-0-resp">\n                        <div class="head w-100 px-5p py-10p bsbb">\n                            <span class="capitalize bold-2 fs-20p">Appointment # <span class="consolas">${e}</span></span>\n                        </div>\n                        <div class="p-5p bsbb w-100 h-91 ovh p-r">\n                            <div class="w-100 h-100 ovys scroll-2 body">\n                                <div class="w-100 h-a my-10p">\n                                    <span class="capitalize pr-5p">with</span><span class="black capitalize" data-holder="true" data-hold="patient"></span>\n                                </div>\n                                <div class="w-100 h-a my-10p">\n                                    <span class="dgray capitalize block">reason for appointment: </span>\n                                    <span class="black capitalize block" data-holder="true" data-hold="subject"> </span>\n                                </div>\n                                <div class="w-100 h-a my-10p">\n                                    <span class="dgray capitalize block">description: </span>\n                                    <span class="black capitalize block" data-holder="true" data-hold="message"> </span>\n                                </div>\n                                <div class="w-100 h-a my-10p" id="time-holder">\n                                    <span class="dgray capitalize block">estimated time: </span>\n                                    <span class="black capitalize block" data-holder="true" data-hold="time">\n                                    </span>\n                                </div>\n                                <div class="w-100 h-a my-10p">\n                                    <span class="dgray capitalize block">date booked: </span>\n                                    <span class="black capitalize block" data-holder="true" data-hold="date_booked">       \n                                </span>\n                            </div>\n                            </div>\n                        </div>\n                    </div>`;let a=s.querySelector("div.body");if(addLoadingTab(a),postschema.body=JSON.stringify({token:getdata("token")}),e=await request(`appointment/${e}`,postschema),!e.success)return alertMessage(e.message);e=e.message,removeLoadingTab(a);let n=Array.from(s.querySelectorAll('[data-holder="true"]'));if(n.forEach(t=>{let s=t.getAttribute("data-hold");-1!=s.indexOf("time")||-1!=s.indexOf("date")?t.innerText=fT(e[s]):t.innerText=e[s]}),e.extra){let t=a.querySelector("div#time-holder"),s=document.createElement("div");s.className="w-100 h-a my-10p",s.innerHTML=`<span class="dgray capitalize block">${Object.keys(e.extra)[0]} </span>\n                            <span class="black capitalize block" data-holder="true" data-hold="${Object.keys(e.extra)[0]}">${e.extra[Object.keys(e.extra)[0]]}</span>`,a.insertBefore(s,t)}}import{alertMessage,getdata,getschema,postschema,request,deletechild,checkEmpty,showRecs,getchips,getPath,calcTime,addsCard,cpgcntn,geturl,sessiondata,addChip,showAvaiAssurances,adcm,addshade,addLoadingTab,removeLoadingTab,showAvaiEmps,fT,promptHpsToChoose,addAuthDiv,RemoveAuthDivs,showFingerprintDiv}from"../../../utils/functions.controller.js";import{addUprofile}from"../../../utils/user.profile.controller.js";import{pushNotifs,userinfo,expirateMssg,getNfPanelLinks,m as messages,DateTime}from"./nav.js";let q,w,e,r,t,y,u,i,o,p,a,s,d,f,g,h,j,k,l,x,c,v,b,n,z,notificationlinks;(async function(){async function e(e,t){try{if(x=e.id,"search-patient"==x){if(f=e.querySelector('form[name="sp-form"]'),s=f.querySelector('input[type="text"]'),setTimeout(e=>{s.focus()},200),b=f.querySelector('button[type="submit"]'),getPath(2)){if(b.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',b.setAttribute("disabled",!0),r=await request(`patient/${getPath(2)}`,postschema),s.value=getPath(2),b.innerHTML='<i class="bx bx-search h-20p w-a center"></i>',b.removeAttribute("disabled"),!r.success)return alertMessage(r.message);addUprofile(r.message)}let t=e.querySelector("span#fingerprint");t.onclick=async function(){let e=await showFingerprintDiv("search");if(e){if(postschema.body=JSON.stringify({token:getdata("token"),fp_data:e,type:"fp"}),r=await request("patient/",postschema),RemoveAuthDivs(),!r.success)return alertMessage(r.message);addUprofile(r.message);let t=new URL(window.location.href);t.pathname=`/hc_provider/search-patient/${r.message.id}`,window.history.pushState({},"",t.toString())}},f.onsubmit=(async e=>{if(e.preventDefault(),!s.value)return 0;if(b.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',b.setAttribute("disabled",!0),r=await request(`patient/${s.value}`,postschema),b.innerHTML='<i class="bx bx-search h-20p w-a center"></i>',b.removeAttribute("disabled"),!r.success)return alertMessage(r.message);addUprofile(r.message);let t=new URL(window.location.href);t.pathname=`/hc_provider/search-patient/${s.value}`,window.history.pushState({},"",t.toString())})}else if("my-account"==x){n=e.querySelector("span.name"),z=getdata("userinfo"),n.textContent=z.Full_name,i=e.querySelector("span.n-img"),i.textContent=z.Full_name.substring(0,1);let t=Array.from(e.querySelectorAll("span.icon-edit-icon"));for(const e of t)e.addEventListener("click",()=>{l=e.getAttribute("data-target"),shedtpopup(l,r)})}else if("create-session"==x)try{f=document.querySelector("form#create-session-form"),i=Array.from(f.querySelectorAll(".form-control"));let e,t=f.querySelector("span#add-symptom"),s=f.querySelector("span#add-decisions"),r=Array.from(f.querySelectorAll("input.extras")),o=f.querySelector('input[name="operations"]');async function a(e){if(e.value){e.parentNode.querySelector("span").classList.replace("hidden","center-2"),postschema.body=JSON.stringify({token:getdata("token")});const t=await request(`patient/${e.value.trim()}`,postschema);if(!t.success)return sessionStorage.removeItem("pinfo"),e.removeAttribute("data-id"),e.parentNode.querySelector("span").classList.replace("center-2","hidden");e.parentNode.querySelector("span").classList.replace("center-2","hidden"),e.value=t.message.Full_name,e.setAttribute("data-id",t.message.id);let s=await showAvaiAssurances(t.message.assurances);l=Array.from(s.querySelectorAll("li.assurance"));for(const e of l)e.addEventListener("click",async function(e){e.preventDefault(),this.classList.add("selected");let a=this.getAttribute("data-id");"null"==a&&(a=null),sessionStorage.setItem("pinfo",JSON.stringify({patient:t.message.id,name:t.message.Full_name,assurance:a,nid:t.message.nid})),deletechild(s,s.parentNode),addsCard("Assurance Selected",!0)})}else e.parentNode.querySelector("span").classList.replace("center-2","hidden")}r.map(function(e){e.onfocus=(t=>{showRecs(e,y[e.id],e.id)})}),o.onfocus=(e=>{showRecs(o,y[o.id],o.id)}),t.onclick=(e=>{let s=t.parentNode,a=s.querySelector("input");if(a.value.trim()){let e=s.querySelector("div.chipsholder");e||(e=document.createElement("div"),e.className="chipsholder p-5p bsbb w-100",e.title="symptoms",s.insertAdjacentElement("beforeEnd",e)),addChip({name:a.value.trim(),id:a.value.trim()},e,["id"]),a.value=null}}),s.onclick=(e=>{let t=s.parentNode,a=t.querySelector("input");if(a.value.trim()){let e=t.querySelector("div.chipsholder");e||(e=document.createElement("div"),e.className="chipsholder p-5p bsbb w-100",e.title="results",t.insertAdjacentElement("beforeEnd",e)),addChip({name:a.value.trim(),id:a.value.trim()},e,["id"]),a.value=null}}),n=i.find(function(e){return"patient"==e.id}),sessiondata("pinfo")&&(n.value=sessiondata("pinfo").name,n.setAttribute("data-id",sessiondata("pinfo").patient)),n.onfocus=(()=>{sessiondata("pinfo")&&(sessiondata("pinfo").nid?n.value=sessiondata("pinfo").nid:n.value=sessiondata("pinfo").patient,n.setAttribute("data-id",sessiondata("pinfo").patient)),e=n.value}),n.onblur=(async()=>{n.value!=e&&(v=await a(n)),sessiondata("pinfo")&&(n.value=sessiondata("pinfo").name,n.setAttribute("data-id",sessiondata("pinfo").patient))});let d=f.querySelector('button[type="submit"]');f.onsubmit=(async e=>{let t,s,a,n,r;a="",n="",s={},v=1,e.preventDefault();for(const e of i)t=checkEmpty(e),t||(v=0),e.classList.contains("chips-check")?("tests"==e.name&&Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","sample","result"])}),"medicines"==e.name?Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","status","quantity","price","result"])}):e.classList.contains("extras")?Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","quantity"])}):"operations"==e.name?Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","operator"])}):Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"))})):e.classList.contains("bevalue")?Object.assign(s,{[e.name]:e.getAttribute("data-id")}):Object.assign(s,{[e.name]:e.value});v&&(Object.assign(s,{assurance:sessiondata("pinfo").assurance}),Object.assign(s,{token:getdata("token")}),postschema.body=JSON.stringify(s),d.setAttribute("disabled",!0),d.textContent="recording session info...",r=await request("addsession",postschema),d.removeAttribute("disabled",!0),d.textContent="create session",alertMessage(r.message))})}catch(e){console.log(e)}else if("view-session"==x){if(A.innerHTML=L,t&&!getPath(2)){let e=new URL(window.location.href);e.pathname=`/hc_provider/view-session/${t}`,window.history.pushState({},"",e.toString())}let s=getPath(2);addLoadingTab(e.querySelector("div.theb"));let a=e.querySelector("input#session-id"),n=e.querySelector('button[name="session-search"]');if(n.onclick=(async t=>{if(t.preventDefault(),""!=a.value&&a.value!=s){s||removeLoadingTab(e.querySelector("div.theb")),s=a.value,postschema.body=JSON.stringify({token:getdata("token")}),addLoadingTab(e.querySelector("div.theb")),n.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',n.setAttribute("disabled",!0);let t=await request(`session/${s}`,postschema);if(t.success&&(A.innerHTML=L,sessionStorage.removeItem("minfo")),n.innerHTML='<i class="bx bx-search h-20p w-a center"></i>',n.removeAttribute("disabled"),!t.success)return alertMessage(t.message);a.value=s;let i=new URL(window.location.href);i.pathname=`/hc_provider/view-session/${s}`,window.history.pushState({},"",i.toString()),t=t.message,o(t)}}),s){postschema.body=JSON.stringify({token:getdata("token")});let e=await request(`session/${s}`,postschema);if(!e.success)return sessionStorage.removeItem("minfo"),alertMessage(e.message);a.value=s,e=e.message,o(e)}}else if("appointments"==x){let t=e.querySelector('ul[data-role="appointments-holder"]');t.innerHTML=null;const s=new Map;g.forEach(e=>{const t=new Date(e.date_booked),a=t.getFullYear();t.setMonth(t.getMonth());const n=new Intl.DateTimeFormat("en-US",{month:"long"}).format(t);s.has(a)||s.set(a,new Map),s.get(a).has(n)||s.get(a).set(n,[]),s.get(a).get(n).push(e)});const a=Array.from(s,([e,t])=>({year:e,months:Array.from(t,([e,t])=>({month:e,appointments:t}))}));for(const e of a)for(const s of e.months){let a=document.createElement("li");a.className="ovh",t.appendChild(a),a.innerHTML=`<div class="w-100 h-70p p-5p my-10p">\n                                            <div class="w-100 h-100 bc-tr-white">\n                                                <div class="header w-100 h-60p card-1 br-5p bc-white p-r block hover-2">\n                                                    <div class="w-100 h-100 flex jc-sb p-5p bsbb">\n                                                        <span class="dgray center capitalize px-10p fs-16p">${s.month} / ${e.year}</span>\n                                                        <span class="px-25p center spanner hover-2" data-role="span">\n                                                            <span class="right-arrow tr-0-3"></span>\n                                                        </span>\n                                                    </div>\n                                                </div>\n                                                <div class="w-100 h-a p-10p bsbb appointment-holder"></div>\n                                            </div>\n                                        </div>`;const n=a.querySelector("div.appointment-holder");for(const e of s.appointments)if("open"!=e.status){let t=document.createElement("div");n.appendChild(t),t.className="w-250p h-a bfull-resp p-5p bsbb iblock",t.innerHTML=`<div class="card">\n                                                        <div class="p-15p capitalize dgray flex jc-sb">\n                                                            <div class="flex">\n                                                                <span class="black fs-20p px-5p hover-2">#</span><span class="center hover-2">${e.id}</span>\n                                                            </div>\n                                                            <span class="btn  btn-sm ${"declined"==e.status?"btn-label-danger":"approved"==e.status?"btn-label-success":(e.status,"btn-label-secondary")}" data-role="button">${e.status}</span>  \n                                                        </div>\n                                                        <div class="p-15p hover-2" data-role="button" data-id="${e.id}" id ="view-appointment">\n                                                            <h5 class="card-title capitalize">${e.subject}</h5>\n                                                            <p class="px-5p">\n                                                            <span class="capitalize fs-14p">appointment with ${e.patient}</span>\n                                                            </p>\n                                                            <p class="px-5p">\n                                                            <span class="capitalize fs-14p">on ${fT(e.time)}</span>\n                                                            </p>\n                                                            <p class="flex">\n                                                                <span class="dgray fs-15p px-5p">${calcTime(e.date_booked)}</span>\n                                                            </p>\n                                                        </div>\n                                                    </div>`}if(!n.innerHTML){let e=document.createElement("div");e.className="ovh center-2",n.appendChild(e),e.innerHTML='<span class="capitalize dgray flex fs-16p bold-2">no entries available</span>'}}let n=Array.from(e.querySelectorAll('[data-role="span"]'));for(const e of n)e.parentNode.parentNode.addEventListener("click",t=>{t.preventDefault(),e.children[0].classList.toggle("down-arrow"),e.children[0].classList.toggle("left-arrow");let s=e.parentNode.parentNode.parentNode.parentNode;s.classList.toggle("h-a")});let i=Array.from(e.querySelectorAll('[data-role="button"]'));i.map(e=>{e.onclick=function(t){if(e.classList.contains("loading"))return 0;if(t.preventDefault(),"appointment"==e.id)addAppointmentDiv();else if("view-appointment"==e.id){let t=e.getAttribute("data-id");viewAppointmentDiv(t)}}})}function o(t){removeLoadingTab(e.querySelector("div.theb")),Object.assign(t.payment_info,{total_amount:Number(t.payment_info.a_amount)+Number(t.payment_info.p_amount)});const s=Array.from(document.querySelectorAll('span[name="info-hol"]')),a=Array.from(document.querySelectorAll('ul[name="looping-info"]'));for(const e of a){let s=e.getAttribute("data-hold"),a=t[s];for(const t of a){Object.assign(t,{total_amount:(Number(t.price)*Number(t.quantity)).toFixed(2)});let a=e.cloneNode(!0),n=Array.from(a.querySelectorAll('[name="looping-info-hol"]'));if("medicines"==s&&("served"==t.status?(a.classList.add("bc-tr-green"),n.find(function(e){return"name"==e.getAttribute("data-hold")}).classList.replace("dgray","green")):a.classList.add("bc-gray"),t.servedOut)){let e=document.createElement("span");e.innerText="( served out )",e.className="fs-10p p-a t-0 mt-50p l-0 ml-25p",a.appendChild(e)}for(const e of n)-1!=e.getAttribute("data-hold").indexOf("quantity")||-1!=e.getAttribute("data-hold").indexOf("amount")?e.innerText=adcm(t[e.getAttribute("data-hold")]):-1!=e.getAttribute("data-hold").indexOf("result")?("positive"==t[e.getAttribute("data-hold")]||"positif"==t[e.getAttribute("data-hold")]?e.classList.add("green"):e.classList.add("red"),e.innerText=t[e.getAttribute("data-hold")]):"decisions"!=s||e.getAttribute("data-hold")?e.innerText=t[e.getAttribute("data-hold")]:e.innerText=t;e.parentNode.appendChild(a)}e.parentNode.removeChild(e)}for(const e of s){let s=e.getAttribute("data-hold");-1!=s.indexOf(".")?(s=s.split("."),-1!=s[1].indexOf("amount")?e.innerText=adcm(t[s[0]][s[1]]):-1!=s[0].indexOf("p_info")&&-1!=s[1].indexOf("name")?(e.innerText=t[s[0]][s[1]],e.classList.add("hover-6","data-buttons"),e.setAttribute("data-role","show-profile"),e.setAttribute("data-id",t[s[0]].id)):e.innerText=t[s[0]][s[1]]):(-1!=e.getAttribute("data-hold").indexOf("status")&&"open"==t[e.getAttribute("data-hold")]&&e.classList.replace("btn-label-secondary","btn-label-success"),e.innerText=t[s])}let n=new popups(t,y.users);const i=Array.from(e.querySelectorAll("span.data-buttons"));i.map(function(s){"close"==s.getAttribute("data-role")&&"closed"==t.status&&(deletechild(s,s.parentNode),s.classList.add("loading"),s.classList.replace("btn-label-primary","btn-label-secondary")),s.onclick=(async a=>{if(a.preventDefault(),s.classList.contains("loading"))return 0;let i=s.getAttribute("data-role");if("test"==i)n.test(y.tests);else if("medication"==i)n.medication(y.medicines);else if("equipment"==i)n.equipment(y.equipments);else if("service"==i)n.service(y.services);else if("operation"==i)n.operation(y.operations);else if("comment"==i)n.comment(t.comment);else if("decision"==i)n.decision();else if("close"==i){postschema.body=JSON.stringify({session:t.session_id,token:getdata("token")}),s.classList.add("loading");let a=await request("close-session",postschema);alertMessage(a.message),a.success?(e.querySelector('[data-hold="status"]').innerText="closed",e.querySelector('[data-hold="status"]').classList.replace("btn-label-success","btn-label-primary"),s.classList.replace("btn-label-primary","btn-label-secondary"),s.innerText="closed",t.status="closed"):s.classList.remove("loading")}else if("show-profile"==i){let e=new URL(window.location.href);e.pathname=`/${getPath()[0]}/search-patient/${s.getAttribute("data-id")}`,window.history.pushState({},"",e.toString()),deletechild(a,a.parentNode);const t=new Event("urlchange",{bubbles:!0});window.dispatchEvent(t)}})})}}catch(e){console.log(e)}}async function o(e){let t=addshade(),s=document.createElement("div");t.appendChild(s),s.className="br-10p cntr card p-10p bsbb w-450p h-a b-mgc-resp",s.innerHTML=`<div class="w-100 h-100 p-5p bp-0-resp">\n            <div class="head w-100 px-5p py-10p bsbb">\n                <span class="capitalize bold-2 fs-20p">Appointment Request from ${e.sender.name}</span>\n            </div>\n            <div class="body p-5p bsbb w-100 h-91 ovh">\n                <div class="w-100 h-100 ovys scroll-2">\n                    <div class="w-100 h-a my-10p">\n                        <span class="dgray capitalize block">reason for appointment: </span>\n                        <span class="black capitalize block">${e.content} </span>\n                    </div>\n                    <div class="w-100 h-a my-10p">\n                        <span class="dgray capitalize block">description: </span>\n                        <span class="black capitalize block">${e.addins?e.addins.content:e.extra.content} </span>\n                    </div>\n                    <div class="w-100 h-a my-10p">\n                        <span class="dgray capitalize block">estimated time: </span>\n                        <span class="black capitalize block" data-holder="date">\n                            <div class="w-30p h-30p px-5p bsbb my-5p">\n                                <div class="sk-grid sk-primary">\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                    <div class="sk-grid-cube"></div>\n                                </div>\n                            </div>\n                        </span>\n                    </div>\n                    <div class="w-100 h-a py-10p mt-20p flex">\n                        <span class="px-10p bsbb">\n                            <button type="button" class="btn btn-primary capitalize" data-role="button" id="approve">approve</button>\n                        </span>\n                        <span class="px-10p bsbb">\n                            <button type="button" class="btn btn-danger capitalize" data-role="button" id="decline">decline</button>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        </div>`;let a=s.querySelector('[data-holder="date"]');postschema.body=JSON.stringify({token:getdata("token")});let n=await request("getAppointmentETA",postschema);n.success?a.innerHTML=fT(n.message):alertMessage(n.message);let i=Array.from(s.querySelectorAll('[data-role="button"]'));i.map(function(s){s.addEventListener("click",async()=>{if(s.classList.contains("loading"))return 0;if("approve"==s.id){postschema.body=JSON.stringify({token:getdata("token"),patient:e.sender.id,subject:e.content,message:e.addins?e.addins.content:e.extra.content,time:n.message,status:"approved",dateadded:e.dateadded}),s.classList.add("loading"),s.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>';let a=await request("add-appointment",postschema);s.innerHTML="approve",s.classList.remove("loading"),a.success&&deletechild(t,t.parentElement),alertMessage(a.message)}else if("decline"==s.id){let s=addshade(),a=document.createElement("div");s.appendChild(a),a.className="br-10p cntr card p-10p bsbb w-450p h-a b-mgc-resp",a.innerHTML='<div class="w-100 h-100 p-5p bp-0-resp">\n                                        <div class="head w-100 px-5p py-10p bsbb">\n                                            <span class="capitalize bold-2 fs-20p">reason for declining</span>\n                                        </div>\n                                        <div class="body p-5p bsbb w-100 h-91 ovh">\n                                            <div class="w-100 h-100 ovys scroll-2">\n                                                <div class="w-100 h-a my-10p">\n                                                    <textarea class="h-100p form-control" placeholder="Reason" name="reason"></textarea>\n                                                    <small class="red hiden capitalize"></small>\n                                                </div>\n                                                <div class="w-100 h-a py-10p mt-20p flex">\n                                                    <span class="px-10p bsbb">\n                                                        <button type="button" class="btn btn-primary capitalize" data-role="button" id="decline-app">proceed</button>\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>';let i=Array.from(a.querySelectorAll('[data-role="button"]'));console.log(e),i.map(function(i){i.addEventListener("click",async()=>{if(i.classList.contains("loading"))return 0;if("decline-app"==i.id){if(!a.querySelector(".form-control").value.trim())return checkEmpty(a.querySelector(".form-control"));postschema.body=JSON.stringify({token:getdata("token"),patient:e.sender.id,subject:e.content,message:e.addins.content,time:n.message,status:"declined",extra:{reason:a.querySelector(".form-control").value.trim()},dateadded:e.dateadded}),i.classList.add("loading"),i.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>';let r=await request("add-appointment",postschema);i.innerHTML="proceed",i.classList.remove("loading"),r.success&&(deletechild(t,t.parentElement),deletechild(s,s.parentElement)),alertMessage(r.message)}})})}})})}function d(t){let a=sessiondata("messages");t.map(t=>{t.addEventListener("click",()=>{if(!t.classList.contains("list-link"))return 0;v=document.querySelector(`div#${t.getAttribute("data-href-target")}`);let n=a.find(function(e){return e.id==t.getAttribute("data-id")});if(v&&n){p=Array.from(v.parentElement.querySelectorAll(".pagecontentsection")),s=p.indexOf(v);let a=new URL(window.location.href);if("test_res_message"==t.getAttribute("data-message-type")||"session_message"==t.getAttribute("data-message-type")){let e;n.addins?e=n.addins.session:n.extra&&(e=n.extra.session),e&&(a.pathname=`/${getPath()[0]}/${t.getAttribute("data-href-target")}/${e}`)}else"__APPNTMNT_MSSG_"==t.getAttribute("data-message-type")?(o(n),a.pathname=`/${getPath()[0]}/${t.getAttribute("data-href-target")}`):a.pathname=`/${getPath()[0]}/${t.getAttribute("data-href-target")}`;window.history.pushState({},"",a.toString()),cpgcntn(p.indexOf(v),p),e(v,null)}})})}z=userinfo;let m=getdata("token");if(m||(window.location.href="../../login/"),!z.success)return localStorage.removeItem("token"),alertMessage(z.message);if(z.success){z=z.message;try{const e=io(geturl(),{query:{id:z.id}});if(e.on("connect",()=>{console.log("Connected to the server")}),e.on("message",e=>{pushNotifs(e),messages.push(e),notificationlinks=getNfPanelLinks(),d(notificationlinks),addsCard(e.title,!0)}),e.on("messagefromserver",e=>{alertMessage(e)}),e.on("accessAuth",t=>{addAuthDiv(e,t)}),e.on("expiratemssg",e=>{expirateMssg(e)}),e.on("selecthp",t=>{let s=promptHpsToChoose(t);s.forEach(t=>{t.addEventListener("click",s=>{s.preventDefault(),e.emit("hpchoosen",{hp:{id:t.getAttribute("data-id"),name:t.getAttribute("data-name")},token:localStorage.getItem("token")})})})}),e.on("changetoken",e=>{alertMessage("token changed"),localStorage.setItem("token",e),window.location.href=window.location.href}),e.emit("messageToId",{recipientId:z.id,message:"wassup"}),"string"!=typeof z.hospital&&"object"==typeof z.hospital&&z.hospital.length>0)return e.emit("getpsforselection",z.hospital),0}catch(e){console.log(e)}}postschema.body=JSON.stringify({token:m});let u=await request("get-hp-employees",postschema);q=await request("getmeds",postschema),f=await request("get-tests",postschema),l=await request("get-equipments",postschema),k=await request("get-services",postschema),j=await request("get-operations",postschema);let h=await request("hcp-appointments",postschema);if(!h.success)return alertMessage(h.message);const g=h.message;if(!(q.success&&f.success&&l.success&&k.success&&j.success&&u.success))return 0;let y={users:u.message,tests:f.message,medicines:q.message,equipments:l.message,services:k.message,operations:j.message};a=getPath(1),c=Array.from(document.querySelectorAll("span.cpcards")),p=Array.from(document.querySelectorAll("div.pagecontentsection"));const w=p.find(function(e){return"view-session"==e.id}),A=w.querySelector("div.theb"),L=A.innerHTML;a?p.forEach(s=>{if(a==s.id)return t=p.indexOf(s),c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),c[t].classList.add("active","bb-1-s-theme","bc-tr-theme","theme"),cpgcntn(t,p,y),e(s),0}):(window.history.pushState("","","./home"),cpgcntn(0,p,y)),window.addEventListener("popstate",function(){const e=new Event("urlchange",{bubbles:!0});window.dispatchEvent(e)}),window.addEventListener("urlchange",function(){a=getPath(1),a?p.forEach(s=>{if(a==s.id)return t=p.indexOf(s),c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),c[t].classList.add("active","bb-1-s-theme","bc-tr-theme","theme"),cpgcntn(t,p),getPath(2)?e(s,getPath(2)):e(s),0}):(window.history.pushState("","","./home"),cpgcntn(0,p))}),c.forEach(t=>{t.addEventListener("click",()=>{c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),t.classList.add("active","bb-1-s-theme","bc-tr-theme","theme");let s=new URL(window.location.href);s.pathname=`/hc_provider/${t.getAttribute("data-item-type")}`,window.history.pushState({},"",s.toString()),cpgcntn(c.indexOf(t),p,y),e(p.find(function(e){return e.id==t.getAttribute("data-item-type")}))})}),notificationlinks=getNfPanelLinks(),d(notificationlinks)})();class popups{constructor(e,t){this.session=e,this.users=t}test(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add a test to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="req-test-info-form" name="req-test-info-form">\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="test" class="form-label">test taken</label>\n                                    <input type="text" class="form-control bevalue" id="test" placeholder="Demo test" name="test">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="sample" class="form-label">sample taken</label>\n                                    <input type="text" class="form-control" id="sample" placeholder="Demo sample" name="sample">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="col-md-12 px-10p py-6p bsbb mb-5p p-r">\n                                    <label for="result" class="form-label">results found</label>\n                                    <input type="text" class="form-control" id="result" placeholder="Demo results" name="result">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp mr-10p bm-a-resp bmy-10p-resp">Proceed</button>\n                                    <button type="button" class="btn btn-label-primary ml-10p capitalize bfull-resp bm-a-resp bmy-10p-resp">Request for tesing</button>\n                                </div>\n                            </form>\n                        </div>';let n=a.querySelector("form"),i=Array.from(n.querySelectorAll("input")),o=i.find(function(e){return e.classList.contains("bevalue")});o.addEventListener("focus",t=>{showRecs(o,e,o.id)})
;let d=n.querySelector('button[type="button"]');d.addEventListener("click",async a=>{if(a.preventDefault(),!o.getAttribute("data-id"))return alertMessage("please select a test to proceed");let n=e.find(function(e){return e.id==o.getAttribute("data-id")});if(!n)return alertMessage("Test not found");if(p=await showAvaiEmps(this.users,{department:n.department}),!p)return;let i=Array.from(p.querySelectorAll(".emp")),l=Array.from(p.querySelectorAll(".dep"));for(const e of i)e.addEventListener("click",async function(e){e.preventDefault();let s=this.getAttribute("data-id");j=JSON.parse(postschema.body),Object.assign(j,{title:"incoming test request",token:getdata("token"),receiver:s,type:"req_test_message",content:`there is an incoming test request called ${n.name} for  ${t.p_info.name}`,extra:{test:n.id,t_name:n.name,session:t.session_id,patient:t.p_info.id,nid:t.p_info.nid,patient_name:t.p_info.name,symptoms:t.symptoms},controller:{looping:!1,recipients:[]}});try{if(postschema.body=JSON.stringify(j),deletechild(p,p.parentNode),d.setAttribute("disabled",!0),d.innerText="notifying the receiver...",r=await request("send-message",postschema),!r.success)return alertMessage(r.message);d.removeAttribute("disabled"),d.innerText="receiver notified !",d.classList.replace("btn-label-primary","btn-label-success"),addsCard("receiver notified !",!0)}catch(e){console.log(e)}});for(const e of l)e.addEventListener("click",async function(a){let i=Array.from(e.parentNode.parentElement.querySelectorAll(".emp"));i=i.map(function(e){return e.getAttribute("data-id")}),j=JSON.parse(postschema.body),Object.assign(j,{title:"incoming test request",token:getdata("token"),receiver:[i],type:"req_test_message",content:`there is an incoming test request called ${n.name} for  ${t.p_info.name}`,extra:{test:n.id,t_name:n.name,session:t.session_id,patient:t.p_info.id,nid:t.p_info.nid,patient_name:t.p_info.name,symptoms:t.symptoms},controller:{looping:!0,recipients:i}});try{if(postschema.body=JSON.stringify(j),d.setAttribute("disabled",!0),d.innerText="notifying the receivers...",r=await request("send-message",postschema),!r.success)return alertMessage(r.message);deletechild(p,p.parentElement),deletechild(s,s.parentNode),d.removeAttribute("disabled"),d.innerText="receivers notified !",d.classList.replace("btn-label-primary","btn-label-success"),addsCard("receivers notified !",!0)}catch(e){console.log(e)}})}),n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:e.classList.contains("bevalue")?e.getAttribute("data-id"):e.value});Object.assign(a,{test:{id:a.test,sample:a.sample,result:a.result}}),Object.assign(a,{session:t.session_id,token:getdata("token")}),delete a.sample,delete a.result,postschema.body=JSON.stringify(a);let r=await request("add-session-test",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}medication(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add a medication to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="add-medicine-form" name="add-medicine-form">\n                                <div class="col-md-12 p-10p bsbb mb-5p p-r">\n                                    <label for="medicines" class="form-label">medicines</label>\n                                    <input type="text" class="form-control extras chips-check" id="medicines" placeholder="Demo medicine" name="medicines">\n                                    <small class="hidden w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp bm-a-resp bmy-10p-resp">Proceed</button>\n                                </div>\n                            </form>\n                        </div>';let n=a.querySelector("form"),i=Array.from(n.querySelectorAll("input")),r=i.find(function(e){return e.classList.contains("extras")});r.addEventListener("focus",t=>{showRecs(r,e,r.id)}),n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","quantity","status"])});Object.assign(a,{session:t.session_id,token:getdata("token")}),postschema.body=JSON.stringify(a);let r=await request("add-session-medicine",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}operation(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add an operation to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="req-test-info-form" name="req-test-info-form">\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="test" class="form-label">operation name</label>\n                                    <input type="text" class="form-control bevalue" id="operation" placeholder="Demo operation" name="operation">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp mr-10p  bm-a-resp bmy-10p-resp">Proceed</button>\n                                    <button type="button" class="btn btn-label-primary ml-10p  capitalize bfull-resp bm-a-resp bmy-10p-resp">Request for tesing</button>\n                                </div>\n                            </form>\n                        </div>';let n=a.querySelector("form"),i=Array.from(n.querySelectorAll("input")),o=i.find(function(e){return e.classList.contains("bevalue")});o.addEventListener("focus",t=>{showRecs(o,e,o.id)});let c=n.querySelector('button[type="button"]');c.addEventListener("click",async e=>{e.preventDefault(),p=await showAvaiEmps(users),l=Array.from(p.querySelectorAll("li.emp"));for(const e of l)e.addEventListener("click",async function(e){e.preventDefault(),this.classList.add("selected");let t=this.getAttribute("data-id");j=JSON.parse(postschema.body),Object.assign(j,{title:"incoming patient",receiver:t,type:"p_message",content:`there is an incoming patient called ${r.message.Full_name}`,extra:{name:r.message.Full_name,patient:r.message.id,nid:r.message.nid,assurance:r.message.assurances},controller:{looping:!1,recipients:[]}}),postschema.body=JSON.stringify(j),deletechild(p,p.parentNode),x.setAttribute("disabled",!0),x.innerText="notifying the receiver...",r=await request("send-message",postschema),x.removeAttribute("disabled"),x.innerText="consultant notified !",x.classList.replace("btn-primary","btn-success"),deletechild(d.parentNode,d.parentNode.parentNode),addsCard("consultant notified !",!0)})}),n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:e.classList.contains("bevalue")?e.getAttribute("data-id"):e.value});Object.assign(a,{session:t.session_id,token:getdata("token")}),Object.assign(a,{operation:{id:a.operation,quantity:a.quantity}}),delete a.quantity,postschema.body=JSON.stringify(a);let r=await request("add-session-operation",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}service(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add a service to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="add-service-info-form" name="add-service-info-form">\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="service" class="form-label">service name</label>\n                                    <input type="text" class="form-control bevalue" id="service" placeholder="Demo service" name="service">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="quantity" class="form-label">quantity</label>\n                                    <input type="number" class="form-control" id="quantity" placeholder="Demo quantity" name="quantity">\n                                    <span class="p-a t-0 t-0 mx-20p r-0 mt-42p capitalize" name="unit-hol"></span>\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp bm-a-resp bmy-10p-resp">Proceed</button>\n                                </div>\n                            </form>\n                        </div>';let n=a.querySelector("form"),i=Array.from(n.querySelectorAll("input")),r=i.find(function(e){return e.classList.contains("bevalue")});r.addEventListener("focus",t=>{showRecs(r,e,r.id)}),r.addEventListener("blur",async()=>{let t=n.querySelector('span[name="unit-hol"]'),s=await new Promise((e,t)=>{setTimeout(()=>{e(r.getAttribute("data-id"))},200)}),a=e.find(function(e){return e.id==s});t.innerText=a.unit}),n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:e.classList.contains("bevalue")?e.getAttribute("data-id"):e.value});Object.assign(a,{session:t.session_id,token:getdata("token")}),Object.assign(a,{service:{id:a.service,quantity:a.quantity}}),delete a.quantity,postschema.body=JSON.stringify(a);let r=await request("add-session-service",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}equipment(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add an equipment to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="equipment-info-form" name="equipment-info-form">\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="equipment" class="form-label">equipment name</label>\n                                    <input type="text" class="form-control bevalue" id="equipment" placeholder="Demo equipment" name="equipment">\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="quantity" class="form-label">quantity</label>\n                                    <input type="number" class="form-control" id="quantity" placeholder="Demo quantity" name="quantity">\n                                    <span class="p-a t-0 t-0 mx-20p r-0 mt-42p capitalize" name="unit-hol"></span>\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp bm-a-resp bmy-10p-resp">Proceed</button>\n                                </div>\n                            </form>\n                        </div>';let n=a.querySelector("form"),i=Array.from(n.querySelectorAll("input")),r=i.find(function(e){return e.classList.contains("bevalue")});r.addEventListener("focus",t=>{showRecs(r,e,r.id)}),r.addEventListener("blur",async()=>{let t=n.querySelector('span[name="unit-hol"]'),s=await new Promise((e,t)=>{setTimeout(()=>{e(r.getAttribute("data-id"))},200)}),a=e.find(function(e){return e.id==s});t.innerText=a.unit}),n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:e.classList.contains("bevalue")?e.getAttribute("data-id"):e.value});Object.assign(a,{session:t.session_id,token:getdata("token")}),Object.assign(a,{equipment:{id:a.equipment,quantity:a.quantity}}),delete a.quantity,postschema.body=JSON.stringify(a);let r=await request("add-session-equipment",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}comment(e){const t=this.session;let s=addshade();a=document.createElement("div"),s.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML=`<div class="head w-100 h-50p py-10p px-15p bsbb">\n                            <span class="fs-18p bold-2 dgray capitalize igrid h-100 card-title">add an operation to session</span>\n                        </div>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="req-test-info-form" name="req-test-info-form">\n                                <div class="col-md-12 px-10p py-6p bsbb p-r">\n                                    <label for="test" class="form-label">comment</label>\n                                    <textarea class="form-control" id="comment" placeholder="Demo comment" name="comment">${e}</textarea>\n                                    <small class="w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp">\n                                    <button type="submit" class="btn btn-primary bfull-resp bm-a-resp bmy-10p-resp">Proceed</button>\n                                </div>\n                            </form>\n                        </div>`;let n=a.querySelector("form"),i=Array.from(n.querySelectorAll(".form-control"));n.addEventListener("submit",async e=>{e.preventDefault(),l=1;for(const e of i)v=checkEmpty(e),v||(l=0);if(l){let e=n.querySelector('button[type="submit"]');e.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',e.setAttribute("disabled",!0);let a={};for(const e of i)Object.assign(a,{[e.name]:e.classList.contains("bevalue")?e.getAttribute("data-id"):e.value});Object.assign(a,{session:t.session_id,token:getdata("token")}),postschema.body=JSON.stringify(a);let r=await request("add-session-comment",postschema);r.success&&deletechild(s,s.parentElement),alertMessage(r.message),e.removeAttribute("disabled"),e.innerHTML="proceed"}})}decision(){const e=this.session;let t=addshade();a=document.createElement("div"),t.appendChild(a),a.className="w-350p h-a p-10p bsbb bc-white cntr zi-10000 br-5p b-mgc-resp card",a.innerHTML='<div class="head w-100 h-50p py-10p px-10p bsbb">\n                            <span class="fs-20p bold-2 dgray capitalize igrid h-100 card-title">add an operation to session</span>\n                        </div>\n                        <span class="dgray px-5p fs-14p my-10p  bsbb capitalize">the diagnosis decisions after all diagonis operations caried out in the  session\'s process</span>\n                        <div class="body w-100 h-a p-5p grid">\n                            <form method="post" id="req-decision-info-form" name="req-decision-info-form">\n                                <div class="input-group my-10p">\n                                    <input type="text" class="form-control chips-check" placeholder="demo decision" name="decisions" id="decision">\n                                    <span class="input-group-text hover-2 us-none" id="add-decision">add</span>\n                                    <small class="hidden w-100 red pl-3p verdana"></small>\n                                </div>\n                                <div class="wrap center-2 px-10p bsbb bblock-resp mt-15p">\n                                    <button type="submit" class="btn btn-primary bfull-resp bm-a-resp bmy-10p-resp">Proceed</button>\n                                </div>\n                            </form>\n                        </div>';let s=a.querySelector("form"),n=Array.from(s.querySelectorAll(".chips-check")),i=s.querySelector("span#add-decision");i.addEventListener("click",e=>{let t=i.parentNode,s=t.querySelector("input");if(s.value.trim()){let e=t.querySelector("div.chipsholder");e||(e=document.createElement("div"),e.className="chipsholder p-5p bsbb w-100",e.title="symptoms",t.insertAdjacentElement("beforeEnd",e)),addChip({name:s.value.trim(),id:s.value.trim()},e,["id"]),s.value=null}}),s.addEventListener("submit",async a=>{a.preventDefault(),l=1;for(const e of n)v=checkEmpty(e),v||(l=0);if(l){let a=s.querySelector('button[type="submit"]');a.innerHTML='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',a.setAttribute("disabled",!0);let i={};for(const e of n)Object.assign(i,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id"])});Object.assign(i,{session:e.session_id,token:getdata("token")}),console.log(i),postschema.body=JSON.stringify(i);let r=await request("add-session-decisions",postschema);r.success&&deletechild(t,t.parentElement),alertMessage(r.message),a.removeAttribute("disabled"),a.innerHTML="proceed"}})}}