import{alertMessage,getdata,getschema,postschema,request,initializeCleave,sessiondata,addLoadingTab,removeLoadingTab,checkEmpty,showRecs,getchips,getPath,addsCard,cpgcntn,geturl,adcm,addshade,deletechild}from"../../../utils/functions.controller.js";import{expirateMssg,pushNotifs,userinfo}from"./nav.js";let q,w,e,t,y,u,i,o,p,a,s,d,f,g,h,j,k,l,x,c,v,b,n,m,z;(async function(){async function s(t,a){try{if(x=t.id,"my-account"==x){n=t.querySelector("span.name"),z=getdata("userinfo"),n.textContent=z.Full_name,i=t.querySelector("span.n-img"),i.textContent=z.Full_name.substring(0,1);let e=Array.from(t.querySelectorAll("span.icon-edit-icon"));for(const t of e)t.addEventListener("click",()=>{l=t.getAttribute("data-target"),shedtpopup(l,r)})}else if("restricted-medications"==x){let s=$(".datatables-medications"),n=document.querySelector("table");if(!n.classList.contains("loaded")){e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"name",title:"Name"},{data:"price",title:"medication's price (RWF)"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                        <button class="btn btn-sm btn-icon delete-medication" data-id="${e}"><i class="bx bx-trash"></i></button>\n                                    </div>`}}],order:[[1,"asc"]],data:a.rstrct_m,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{id:"add-medic","data-bs-target":"#add-medicine"}}],initComplete:function(){this.api().columns(3).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Measuring Unit </option></select>').appendTo(".employee-position").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}});let r=Array.from(t.querySelectorAll("button.delete-medication"));r.forEach(t=>{t.onclick=async function(t){t.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_medicines",assurance:a.id,needle:this.getAttribute("data-id")});var s=e.row(t.target.closest("tr"));s.remove().draw();let n=await request("rAenrs",postschema);n.success,alertMessage(n.message)}});let o=t.querySelector("#add-medic");o.onclick=function(){let s=this.getAttribute("data-bs-target"),n=t.querySelector(`div${s}`);n=n.cloneNode(!0),d=addshade(),d.appendChild(n);let r=n.querySelector("form"),o=Array.from(r.querySelectorAll("input"));o[0].onfocus=(e=>{e.preventDefault(),showRecs(o[0],m.message,o[0].id)}),r.onsubmit=(async t=>{t.preventDefault(),l=1;for(const e of o)v=checkEmpty(e),v||(l=0);if(l){let t=r.querySelector('button[type="submit"]');t.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',t.setAttribute("disabled",!0);let s={};for(const e of o)Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","name","price"])});Object.assign(s,{assurance:this.assurance,token:getdata("token"),assurance:a.id}),postschema.body=JSON.stringify(s);let n=await request("aMeDtA",postschema);s.medicines.forEach(t=>{e.row.add(t).draw()}),n.success&&deletechild(d,d.parentElement),alertMessage(n.message),t.removeAttribute("disabled"),t.innerHTML="proceed"}})},n.classList.add("loaded"),s.find("tbody").on("click",".delete-employee",function(){confirm("Are you sure you want to delete this employee?")&&e.row($(this).parents("tr")).remove().draw()})}}else if("restricted-tests"==x){let s=$(".datatables-tests"),n=t.querySelector("table");n.classList.contains("loaded")||(e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"name",title:"Name"},{data:"price",title:"Test's price (RWF)"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                        <button class="btn btn-sm btn-icon delete-test" data-id="${e}"><i class="bx bx-trash"></i></button>\n                                    </div>`}}],order:[[1,"asc"]],data:a.rstrct_t,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{id:"add-test","data-bs-target":"#add-test"}}],initComplete:function(){this.api().columns(3).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Measuring Unit </option></select>').appendTo(".employee-position").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}}));let r=Array.from(t.querySelectorAll("button.delete-test"));r.forEach(t=>{t.onclick=async function(t){t.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_tests",assurance:a.id,needle:this.getAttribute("data-id")});let s=await request("rAenrs",postschema);if(s.success){alertMessage(s.message);var n=e.row(t.target.closest("tr"));n.remove().draw()}else alertMessage(s.message)}});let o=t.querySelector("#add-test");o.onclick=function(){let t=this.getAttribute("data-bs-target"),s=document.querySelector(`div${t}`);s=s.cloneNode(!0),d=addshade(),d.appendChild(s);let n=s.querySelector("form"),r=Array.from(n.querySelectorAll("input"));r[0].onfocus=(e=>{e.preventDefault(),showRecs(r[0],f.message,r[0].id)}),n.onsubmit=(async t=>{t.preventDefault(),l=1;for(const e of r)v=checkEmpty(e),v||(l=0);if(l){let t=n.querySelector('button[type="submit"]');t.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',t.setAttribute("disabled",!0);let s={};for(const e of r)Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","name","price"])});Object.assign(s,{assurance:this.assurance,token:getdata("token"),assurance:a.id}),postschema.body=JSON.stringify(s);let o=await request("aTesTA",postschema);o.success&&(s.tests.forEach(t=>{e.row.add(t).draw()}),deletechild(d,d.parentElement)),alertMessage(o.message),t.removeAttribute("disabled"),t.innerHTML="proceed"}})},n.classList.add("loaded"),s.find("tbody").on("click",".delete-employee",function(){confirm("Are you sure you want to delete this employee?")&&e.row($(this).parents("tr")).remove().draw()})}else if("restricted-operations"==x){let s=$(".datatables-operations"),n=t.querySelector("table");n.classList.contains("loaded")||(e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"name",title:"Name"},{data:"price",title:"Operation's price (RWF)"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                        <button class="btn btn-sm btn-icon delete-operation" data-id="${e}"><i class="bx bx-trash"></i></button>\n                                    </div>`}}],order:[[1,"asc"]],data:a.rstrct_o,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{id:"add-operation","data-bs-target":"#add-operation-modal"}}],initComplete:function(){this.api().columns(3).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Measuring Unit </option></select>').appendTo(".employee-position").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}}));let r=Array.from(t.querySelectorAll("button.delete-operation"));r.forEach(t=>{t.onclick=async function(t){t.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_operations",assurance:a.id,needle:this.getAttribute("data-id")});var s=e.row(t.target.closest("tr"));s.remove().draw();let n=await request("rAenrs",postschema);n.success,alertMessage(n.message)}});let o=t.querySelector("#add-operation");o.onclick=function(){let s=this.getAttribute("data-bs-target"),n=t.querySelector(`div${s}`);n=n.cloneNode(!0),d=addshade(),d.appendChild(n);let r=n.querySelector("form"),o=Array.from(r.querySelectorAll("input"));o[0].onfocus=(e=>{e.preventDefault(),showRecs(o[0],h.message,o[0].id)}),r.onsubmit=(async t=>{t.preventDefault(),l=1;for(const e of o)v=checkEmpty(e),v||(l=0);if(l){let t=r.querySelector('button[type="submit"]');t.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',t.setAttribute("disabled",!0);let s={};for(const e of o)Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","name","price"])});Object.assign(s,{assurance:this.assurance,token:getdata("token"),assurance:a.id}),postschema.body=JSON.stringify(s);let n=await request("aOpeTA",postschema);n.success&&(s.operations.forEach(t=>{e.row.add(t).draw()}),deletechild(d,d.parentElement)),alertMessage(n.message),t.removeAttribute("disabled"),t.innerHTML="proceed"}})},n.classList.add("loaded"),s.find("tbody").on("click",".delete-employee",function(){confirm("Are you sure you want to delete this employee?")&&e.row($(this).parents("tr")).remove().draw()})}else if("restricted-services"==x){let s=$(".datatables-services"),n=t.querySelector("table");n.classList.contains("loaded")||(e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"name",title:"Name"},{data:"price",title:"service's price (RWF)"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                        <button class="btn btn-sm btn-icon delete-service" data-id="${e}"><i class="bx bx-trash"></i></button>\n                                    </div>`}}],order:[[1,"asc"]],data:a.rstrct_s,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{id:"add-service","data-bs-target":"#add-service-modal"}}],initComplete:function(){this.api().columns(3).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Measuring Unit </option></select>').appendTo(".employee-position").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}}));let r=Array.from(t.querySelectorAll("button.delete-service"));r.forEach(t=>{t.onclick=async function(s){s.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_services",assurance:a.id,needle:this.getAttribute("data-id")});var n=e.row(s.target.closest("tr"));n.remove().draw();let r=await request("rAenrs",postschema);r.success?(alertMessage(r.message),deletechild(t.parentNode.parentNode.parentNode,t.parentNode.parentNode.parentNode.parentElement)):alertMessage(r.message)}});let o=t.querySelector("#add-service");o.onclick=function(){let s=this.getAttribute("data-bs-target"),n=t.querySelector(`div${s}`);n=n.cloneNode(!0),d=addshade(),d.appendChild(n);let r=n.querySelector("form"),o=Array.from(r.querySelectorAll("input"));o[0].onfocus=(e=>{e.preventDefault(),showRecs(o[0],b.message,o[0].id)}),r.onsubmit=(async t=>{t.preventDefault(),l=1;for(const e of o)v=checkEmpty(e),v||(l=0);if(l){let t=r.querySelector('button[type="submit"]');t.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',t.setAttribute("disabled",!0);let s={};for(const e of o)Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","name","price"])});s.services.forEach(t=>{e.row.add(t).draw()}),Object.assign(s,{assurance:this.assurance,token:getdata("token"),assurance:a.id}),postschema.body=JSON.stringify(s);let n=await request("aSerTA",postschema);n.success&&deletechild(d,d.parentElement),alertMessage(n.message),t.removeAttribute("disabled"),t.innerHTML="proceed"}})},n.classList.add("loaded"),s.find("tbody").on("click",".delete-employee",function(){confirm("Are you sure you want to delete this employee?")&&e.row($(this).parents("tr")).remove().draw()})}else if("restricted-equipments"==x){let s=$(".datatables-equipments"),n=t.querySelector("table");n.classList.contains("loaded")||(e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"name",title:"Name"},{data:"price",title:"equipment's price (RWF)"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                        <button class="btn btn-sm btn-icon delete-equipment" data-id="${e}"><i class="bx bx-trash"></i></button>\n                                    </div>`}}],order:[[1,"asc"]],data:a.rstrct_e,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{id:"add-equipment","data-bs-target":"#add-equipment-modal"}}],initComplete:function(){this.api().columns(3).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Measuring Unit </option></select>').appendTo(".employee-position").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}}));let r=Array.from(t.querySelectorAll("button.delete-equipment"));r.forEach(t=>{t.onclick=async function(s){s.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_equipments",assurance:a.id,needle:this.getAttribute("data-id")});var n=e.row(s.target.closest("tr"));n.remove().draw();let r=await request("rAenrs",postschema);r.success?(alertMessage(r.message),deletechild(t.parentNode.parentNode.parentNode,t.parentNode.parentNode.parentNode.parentElement)):alertMessage(r.message)}});let o=t.querySelector("#add-equipment");o.onclick=function(){let s=this.getAttribute("data-bs-target"),n=t.querySelector(`div${s}`);n=n.cloneNode(!0),d=addshade(),d.appendChild(n);let r=n.querySelector("form#add-equipment-form"),o=Array.from(r.querySelectorAll("input"));o[0].onfocus=(e=>{e.preventDefault(),showRecs(o[0],g.message,o[0].id)}),r.onsubmit=(async t=>{t.preventDefault(),l=1;for(const e of o)v=checkEmpty(e),v||(l=0);if(l){let t=r.querySelector('button[type="submit"]');t.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',t.setAttribute("disabled",!0);let s={};for(const e of o)Object.assign(s,{[e.name]:getchips(e.parentNode.querySelector("div.chipsholder"),["id","name","price"])});Object.assign(s,{assurance:this.assurance,token:getdata("token"),assurance:a.id}),s.equipments.forEach(t=>{e.row.add(t).draw()}),postschema.body=JSON.stringify(s);let n=await request("aEquTA",postschema);n.success&&deletechild(d,d.parentElement),alertMessage(n.message),t.removeAttribute("disabled"),t.innerHTML="proceed"}})},n.classList.add("loaded"),s.find("tbody").on("click",".delete-employee",function(){confirm("Are you sure you want to delete this employee?")&&e.row($(this).parents("tr")).remove().draw()})}else if("medical-prescriptions"==x){let n=t.querySelector("table");n.classList.contains("loaded")||addLoadingTab(t.querySelector("div.theb"));let r=t.querySelector("form#hp-form"),o=r.querySelector("input");function s(a){removeLoadingTab(t.querySelector("div.theb"));let s=$(".datatables-prescriptions");n.classList.contains("loaded")&&e.destroy(),e=s.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:"",title:""},{data:"p_info.name",title:"patient"},{data:"hp_info.name",title:"health facility"},{data:"p_info.insurance.number",title:"insurance number"},{data:"payment_info.a_amount",title:"amount (RWF)"},{data:"dateclosed",title:"date"},{title:"Action",data:"id"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="capitalize">${e}</span>`}},{targets:2,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="">${e}</span>`}},{targets:3,searchable:1,orderable:!1,render:function(e,t,a,s){return`<span class="">${e}</span>`}},{targets:4,searchable:!1,orderable:1,render:function(e,t,a,s){return`<span class="">${adcm(e)}</span>`}},{targets:5,searchable:1,orderable:1,render:function(e,t,a,s){return`<span class="">${e}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,s){return`<div class="d-inline-block text-nowrap">\n                                            <button class="btn btn-sm btn-icon delete-equipment" data-id="${e}"><i class="bx bx-show"></i></button>\n                                        </div>`}}],order:[[1,"asc"]],data:a,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]}],initComplete:function(){n.classList.add("loaded"),this.api().columns(2).every(function(){var e=this,t=$('<select class="form-select text-capitalize"><option value=""> Select Health Facility </option></select>').appendTo(".health-facility").on("change",function(){var t=$.fn.dataTable.util.escapeRegex($(this).val());e.search(t?"^"+t+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,a){t.append('<option value="'+e+'">'+e+"</option>")})})}})}o.onfocus=function(e){e.preventDefault(),showRecs(this,y.message,this.id)},r.onsubmit=async function(e){if(e.preventDefault(),!o.getAttribute("data-id"))return 0;let n=o.getAttribute("data-id");postschema.body=JSON.stringify({token:getdata("token"),hospital:n,assurance:a.id});let i=r.querySelector("button");i.innerHTML='<span class="spinner-border" role="status" aria-hidden="true"></span>',i.setAttribute("disabled",!0);let c=await request("gAsSuMH",postschema);if(i.innerHTML='<i class="bx bx-search h-20p w-a center"></i>',i.removeAttribute("disabled"),!c.success)return alertMessage(c.message);t.querySelector(".health-facility").innerHTML=null,s(c.message)},$.fn.dataTable.ext.search.push(function(e,t,a){if(e.nTable.classList.contains("datatables-prescriptions")){let e=d.value,a=u.value,s=new Date(t[5]).toISOString().split("T")[0];return""===e&&""===a||""===e&&s<=a||e<=s&&""===a||e<=s&&s<=a}return!0});let i=Array.from(t.querySelectorAll("button.view"));i.forEach(e=>{e.onclick=async function(t){t.preventDefault(),postschema.body=JSON.stringify({token:getdata("token"),type:"rstctd_equipments",assurance:a.id,needle:this.getAttribute("data-id")});let s=await request("rAenrs",postschema);s.success?(alertMessage(s.message),deletechild(e.parentNode.parentNode.parentNode,e.parentNode.parentNode.parentNode.parentElement)):alertMessage(s.message)}});let c=t.querySelector('form[name="date-range"]'),l=Array.from(c.querySelectorAll("input")),d=l[0],u=l[1];c.onsubmit=function(t){t.preventDefault();let a={};e.draw();for(const e of l){if(!e.value)return 0;Object.assign(a,{[e.id]:new Date(e.value).toISOString().split("T")[0]})}}}}catch(e){console.log(e)}}z=userinfo;let o=getdata("token");if(o||(window.location.href="../../login/"),!z.success)return localStorage.removeItem("token"),alertMessage(z.message);if(z.success){z=z.message;try{const e=io(geturl(),{query:{id:z.id}});e.on("connect",()=>{console.log("Connected to the server")}),e.on("message",e=>{pushNotifs(e),addsCard(e.title,!0)}),e.on("expiratemssg",e=>{expirateMssg(e)}),e.on("selecthp",t=>{var a=document.createElement("div");document.body.appendChild(a);for(const e of t)a.innerHTML+=`<div id="${e.id}" class="verdana hover p-5p">${e.name}</div>`;let s=a.querySelectorAll("div");s.forEach(t=>{t.addEventListener("click",a=>{a.preventDefault(),e.emit("hpchoosen",{hp:t.id,token:localStorage.getItem("token")})})})}),e.on("changetoken",e=>{window.alert("token changed"),localStorage.setItem("token",e),window.location.href=window.location.href}),e.emit("messageToId",{recipientId:z.id,message:"wassup"}),"string"!=typeof z.hospital&&"object"==typeof z.hospital&&z.hospital.length>0&&e.emit("getpsforselection",z.hospital)}catch(e){console.log(e)}}postschema.body=JSON.stringify({token:o});const u=await request("assurance",postschema),m=await request("getmeds",postschema),b=await request("get-services",postschema),f=await request("get-tests",postschema),h=await request("get-operations",postschema),g=await request("get-equipments",postschema),y=await request("gAsSuHP",postschema);if(!(u.success&&m.success&&f.success&&h.success&&g.success&&b.success&&y.success))return alertMessage(u.message);let w=u.message;a=getPath(1),c=Array.from(document.querySelectorAll("span.cpcards")),p=Array.from(document.querySelectorAll("div.pagecontentsection")),a?p.forEach(e=>{if(a==e.id)return t=p.indexOf(e),c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),c[t].classList.add("active","bb-1-s-theme","bc-tr-theme","theme"),cpgcntn(t,p,w),s(e,w),0}):(window.history.pushState("","","./home"),cpgcntn(0,p,w)),window.onpopstate=function(){a=getPath(1),a?p.forEach(e=>{if(a==e.id)return t=p.indexOf(e),c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),c[t].classList.add("active","bb-1-s-theme","bc-tr-theme","theme"),cpgcntn(t,p),s(e,w),0}):(window.history.pushState("","","./home"),cpgcntn(0,p),s(p[0]))},c.forEach(e=>{e.addEventListener("click",()=>{c.forEach(e=>{e.classList.remove("active","bb-1-s-theme","bc-tr-theme","theme")}),e.classList.add("active","bb-1-s-theme","bc-tr-theme","theme");let t=new URL(window.location.href);t.pathname=`/insurance_manager/${e.getAttribute("data-item-type")}`,window.history.pushState({},"",t.toString()),cpgcntn(c.indexOf(e),p,w);let a=p.find(function(t){return t.id==e.getAttribute("data-item-type")});a&&s(a,w)})})})();