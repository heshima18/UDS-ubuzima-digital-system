import{alertMessage,getdata,getschema,postschema,request,initializeCleave,checkEmpty,showRecs,getchips}from"../../../utils/functions.controller.js";let q,w,e,r,t,y,u,i,o,p,a,s,d,f,g,h,j,k,l,z,x,c,v,b,n,m;u=getdata("token"),u||(window.location.href="../../login"),async function(){m=await request("get-map",getschema),postschema.body=JSON.stringify({token:getdata("token")});try{f=document.querySelector("form#add-province-form"),i=Array.from(f.querySelectorAll(".form-control")),b=f.querySelector('button[type="submit"]')}catch(t){console.log(t)}f.addEventListener("submit",async t=>{t.preventDefault(),v=1;for(const t of i)n=checkEmpty(t),n||(v=0);if(v){x={};for(const t of i)Object.assign(x,{[t.name]:t.value});Object.assign(x,{token:getdata("token")}),postschema.body=JSON.stringify(x),b.setAttribute("disabled",!0),b.textContent="Recording Province info...",a=await request("add-province",postschema),b.removeAttribute("disabled"),b.textContent="Submit",a.success,alertMessage(a.message)}}),$(document).ready(function(){if(!m.success)return alertMessage(m.message);m=m.message;for(const t of m)m[m.indexOf(t)]=t.provinces[0];var t=$(".datatables-health-posts"),e=t.DataTable({dom:'<"row mx-2"<"col-md-2"<"me-3"l>><"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>>t<"row mx-2"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sLengthMenu:"_MENU_",search:"",searchPlaceholder:"Search..."},columns:[{data:""},{data:"name",title:"name"},{data:"districts",title:"districts"},{data:"",title:"Action"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(){return""}},{targets:1,searchable:1,orderable:1,render:function(t,e,a,n){return`<span class='d-block fw-semibold'>${t}</span>`}},{targets:2,searchable:1,orderable:1,render:function(t,e,a,n){return`<span class='d-block fw-semibold'>${a.districts.length}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(t,e,a,n){return`<div class="d-inline-block text-nowrap">\n                                    <button class="btn btn-sm btn-icon" data-bs-toggle="modal" data-bs-target="#view-health-post" data-id="${a.id}"><i class="bx bx-show-alt"></i></button>\n                                    <button class="btn btn-sm btn-icon" data-bs-toggle="modal" data-bs-target="#update-health-post" data-id="${a.id}"><i class="bx bx-edit"></i></button>\n                                    <button class="btn btn-sm btn-icon delete-province" data-id="${a.id}"><i class="bx bx-trash"></i></button>\n                                </div>`}}],order:[[1,"asc"]],data:m,buttons:[{extend:"collection",className:"btn btn-outline-secondary dropdown-toggle mx-3",text:'<i class="bx bx-export me-1"></i>Export',buttons:[{extend:"print",text:'<i class="bx bx-printer me-2" ></i>Print',className:"dropdown-item"},{extend:"excel",text:'<i class="bx bxs-file-export me-2"></i>Excel',className:"dropdown-item"},{extend:"pdf",text:'<i class="bx bxs-file-pdf me-2"></i>Pdf',className:"dropdown-item"}]},{text:'<i class="bx bx-plus me-0 me-sm-1"></i><span class="d-none d-sm-inline-block">Add New</span>',className:"add-new btn btn-primary",attr:{"data-bs-toggle":"modal","data-bs-target":"#add-province"}}],responsive:{details:{display:$.fn.dataTable.Responsive.display.modal({header:function(t){return"Details of "+t.data().name}}),type:"column",renderer:function(t,e,a){return a=$.map(a,function(t,e){return""!==t.title?'<tr data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><td>'+t.title+":</td> <td>"+t.data+"</td></tr>":""}).join(""),!!a&&$('<table class="table"/><tbody />').append(a)}}},initComplete:function(){}});t.find("tbody").on("click",".delete-province",function(){confirm("Are you sure you want to delete this province?")&&e.row($(this).parents("tr")).remove().draw()})})}();